<#include "../_inc/_layout.html"/> 

<#macro script>

function del(id) {
	jQuery.mm.del('${CPATH}/admin/role/delete?ucode=${ucode}&id=' + id);
}

function batchAction() {
	var $form = $("#form");
	$form.attr("action", "${CPATH}/admin/role/batchDelete?ucode=${ucode}&c=${c!}&p=${p!}");
	
	jQuery.mm.batchAction('#form', '请选择角色记录');
}
	$("input").on("keydown",function(){
		if (event.keyCode == 13) {
			event.keyCode = 0;
			event.returnValue = false;
		}
	});
</#macro>

<@layout active_id=p child_active_id=c>

<section class="content-header">
	<h1>角色管理</h1>
	<ol class="breadcrumb">
		<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
       	<li><a href="#">用户权限</a></li>
       	<li class="active">角色管理</li>
	</ol>
</section>
<!-- Main content -->
<section class="content">
	<div class="row content-row">
		<div class="jp-left">
		<@shiro.hasPermission name="/admin/role/edit,/admin/all">
			<a href="${CPATH}/admin/role/edit?c=${c!}&p=${p!}" class="btn btn-sm btn-primary btn-flat"><i class="fa fa-plus"></i> 新增 </a>
			<a href="javascript:void(0);" onclick="batchAction()" class="btn btn-sm btn-danger btn-flat"><i class="fa fa-remove"></i> 删除 </a>
		</@shiro.hasPermission>
		</div>
		<form class="form-horizontal" style="float: right" action="${CPATH}/admin/role?c=${c!}&p=${p!}" method="post">
			<div class="input-group input-group-sm">
				<input id="post-search-input" class="form-control" type="search" value="${k!}" name="k" placeholder="搜索名称">&nbsp; 
				<input id="search-submit" class="btn btn-default btn-sm btn-flat" type="submit" value="搜索">
			</div>
		</form>
	</div>
	<!-- <div class="row content-row">
		<div class="jp-left">
			<select style="width: 120px" class="form-control input-sm" name="action" id="action">
				<option value="">==批量操作==</option>
				<option value="delete">删除</option>
			</select>
		</div>
		
		<div class="jp-left">
			<button class="btn btn-sm btn-default" type="button" onclick="batchAction()">&nbsp;应用</button>
		</div>
		
		<div class="jp-right">
			<a href="${CPATH}/admin/systems/edit?c=${c!}&p=${p!}" class="btn btn-sm btn-primary"> 新增 </a>
		</div>
	</div> -->
	<div class="box ">
		<!-- /.box-header -->
		<div class="box-body jp-common-pad">
			<form action="" method="POST" id="form">
				<table class="table table-striped">
					<thead>
						<tr>
							<th style="width: 20px">
								<label class="jp-common-pad "> 
									<input class="jp-common-pad " id="dataItem" onclick="checkAll(this)" title="全选" type="checkbox">
								</label>
							</th>
							<th style="width: 20%">角色名称</th>
							<th>角色编号</th>
							<th>部门</th>
							<th>排序</th>
							<@shiro.hasPermission name="/admin/role/edit,/admin/all">
							<th style="width: 20%">操作</th>
							</@shiro.hasPermission>
						</tr>
					</thead>
					<tbody>
						<#if page??> <#list page.getList() as bean>
						<tr class="jp-onmouse">
							<td>
								<label class="jp-common-pad"> 
									<input class="jp-common-pad" name="dataItem" type="checkbox" value="${(bean.id)!}">
								</label>
							</td>
							<td>
								<a href="${CPATH}/admin/role/edit?id=${bean.id}&c=${c!}&p=${p!}">${bean.role_name!}</a>
							</td>
							<td>${bean.role_code!}</td>
							<td>${bean.dept_name!}</td>
							<td>${bean.orderList!}</td>
							<td>
							<@shiro.hasPermission name="/admin/role/edit,/admin/all">
								<a href="${CPATH}/admin/role/edit?id=${bean.id}&c=${c!}&p=${p!}" class="btn btn-xs bg-olive btn-flat">编辑</a>
								<a href="javascript:void(0);" onclick="del('${bean.id}')" class="btn btn-xs btn-danger btn-flat">删除</a>
								<a href="${CPATH}/admin/role/permission?id=${bean.id}&roleName=${bean.role_name}&c=${c!}&p=${p!}" class="btn btn-xs btn-primary btn-flat">分配权限</a>
							</@shiro.hasPermission>
							</td>
						</tr>
						</#list> </#if>
					</tbody>
				</table>
			</form>
		</div>
		<!-- /.box-body -->
	</div>
	<!-- /.box -->

	<div class="cf">
		<div class="pull-right"><#include "../_inc/_paginate_wrapper.html" /></div>
	</div>
</section>	
</@layout>