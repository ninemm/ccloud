<#include "../_inc/_layout.html"/> 

<#macro script>

function del(id) {
	jQuery.mm.del('${CPATH}/admin/goodsAttribute/delete?ucode=${ucode}&id=' + id);
}

function enable(obj,id) {
	$.ajax({
		url:"${CPATH}/admin/goodsAttribute/enable",
		type:"post",
		data:{"id":id},
		dataType:"json",
		success:function(data) {
			if(data.errorCode == 0) {
				toastr.success(data.message, '操作成功');
				if ($(obj).html() == "停用") {
					$(obj).html("启用");
				} else {
					$(obj).html("停用");
				}
			} else {
				toastr.error(data.message,'操作失败');
			}			
		}
	});
}

function batchAction() {
	var $form = $("#form");
	$form.attr("action", "${CPATH}/admin/goodsAttribute/batchDelete?ucode=${ucode}&c=${c!}&p=${p!}");
	
	jQuery.mm.batchAction('#form', '请选择系统记录');
}
</#macro>

<@layout active_id=p child_active_id=c>

<section class="content-header">
	<h1>商品属性<#if typeName??>(${typeName})</#if></h1>
	<ol class="breadcrumb">
		<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
       	<li><a href="#">商品管理</a></li>
       	<li class="active">商品属性</li>
	</ol>
</section>
<!-- Main content -->
<section class="content">
	<div class="row content-row">
		<div class="jp-left">
		<@shiro.hasPermission name="/admin/goodsAttribute/edit,/admin/all">
			<a href="${CPATH}/admin/goodsAttribute/edit?c=${c!}&p=${p!}" class="btn btn-sm btn-primary btn-flat"><i class="fa fa-plus"></i> 新增 </a>
			<a href="javascript:void(0);" onclick="batchAction()" class="btn btn-sm btn-danger btn-flat"><i class="fa fa-remove"></i> 删除 </a>
		</@shiro.hasPermission>	
		</div>
		<form class="form-horizontal" style="float: right" action="${CPATH}/admin/goodsAttribute?c=${c!}&p=${p!}" method="post">
			<div class="input-group input-group-sm">
				<input id="post-search-input" class="form-control" type="search" value="${k!}" name="k" placeholder="搜索名称">&nbsp; 
				<input id="search-submit" class="btn btn-sm btn-primary btn-flat" type="submit" value="搜索">
			</div>
		</form>
	</div>
	
	<div class="box ">
		<!-- /.box-header -->
		<div class="box-body jp-common-pad">
			<form action="" method="POST" id="form">
				<table class="table table-striped">
					<thead>
						<tr>
							<th style="width: 20px">
								<label class="jp-common-pad "> 
									<input class="jp-common-pad " id="dataItem" onclick="checkAll(this)" title="全选" type="checkbox">
								</label>
							</th>
							<th style="width: 20%">属性名称</th>
							<th>商品类型</th>
							<th>属性类型</th>
							<th>是否必填</th>
							<th>是否启用</th>							
							<th>排序</th>
							<@shiro.hasPermission name="/admin/goodsAttribute/edit,/admin/all">
							<th>操作</th>
							</@shiro.hasPermission>
						</tr>
					</thead>
					<tbody>
						<#if page.getList().size() gt 0> <#list page.getList() as bean>
						<tr class="jp-onmouse">
							<td>
								<label class="jp-common-pad"> 
									<input class="jp-common-pad" name="dataItem" type="checkbox" value="${(bean.id)!}">
								</label>
							</td>
							<td>
								<a href="${CPATH}/admin/goodsAttribute/edit?id=${bean.id}&c=${c!}&p=${p!}">${bean.name!}</a>
							</td>
							<td>${bean.type_name!}</td>
							<td>
								<#if (bean.attribute_type)! == "1">
								文本
								<#elseif (bean.attribute_type)! == "2">
								数字
								<#elseif (bean.attribute_type)! == "3">
								字母
								<#elseif (bean.attribute_type)! == "4">
								单选项
								<#elseif (bean.attribute_type)! == "5">
								多选项
								<#else>
								日期
								</#if>
							</td>
							<td><#if bean.is_required == 0>否<#else>是</#if></td>
							<td><#if bean.is_enabled == 0>否<#else>是</#if></td>
							<td>${bean.orderList!}</td>
							<td>
							<@shiro.hasPermission name="/admin/goodsAttribute/edit,/admin/all">
								<a href="${CPATH}/admin/goodsAttribute/edit?id=${bean.id}&c=${c!}&p=${p!}" class="btn btn-xs bg-olive btn-flat">编辑</a>
								<a href="javascript:void(0);" onclick="del('${bean.id}')" class="btn btn-xs btn-danger btn-flat">删除</a>
								<a href="javascript:void(0);" onclick="enable(this,'${bean.id}')" class="btn btn-xs btn-info btn-flat"><#if bean.is_enabled == 1>停用<#else>启用</#if></a>
							</@shiro.hasPermission>	
							</td>
						</tr>
						</#list>
						<#else>
							<tr class="jp-onmouse">
								<td colspan="8" align=center>
									数据为空
								</td>
							</tr> 
						</#if>
					</tbody>
				</table>
			</form>
		</div>
		<!-- /.box-body -->
	</div>
	<!-- /.box -->

	<div class="cf">
		<div class="pull-right"><#include "../_inc/_paginate_wrapper.html" /></div>
	</div>
</section>	
</@layout>