<#include "../_inc/_layout.html"/>

<#macro script_import>
	<!-- bootstrapvalidator -->
	<script src="${CPATH}/static/plugins/bootstrapvalidator/bootstrapValidator.js"></script>
	<!-- bootstrapvalidator -->
	<!-- bootstrap-datetimepicker -->
	<script src="${CPATH}/static/plugins/datetimepicker/bootstrap-datetimepicker.min.js"></script>
	<script src="${CPATH}/static/plugins/datetimepicker/bootstrap-datetimepicker.zh-CN.js"></script> 
</#macro>

<#macro css_import>
	<!-- bootstrapvalidator -->
	<link rel="stylesheet" href="${CPATH}/static/plugins/bootstrapvalidator/bootstrapValidator.css">
	<!-- bootstrap-datetimepicker -->
    <link rel="stylesheet" href="${CPATH}/static/plugins/datetimepicker/bootstrap-datetimepicker.min.css"> 
</#macro>

<#macro script>

	var $form = $("#form");

	$(function() {
		//initCarWarehouse();
		jQuery.mm.initValidator('#form', validatorFields);
		jQuery.mm.initDatetimepicker('form', '#startDate', 'startDate', 'yyyy-MM-dd', 2, 4, 2);
		jQuery.mm.initDatetimepicker('form', '#endDate', 'endDate', 'yyyy-MM-dd', 2, 4, 2); 

	});

	var validatorFields = {
		'parent_name': {
			validators: {
				notEmpty: { message: '部门不能为空' },
			}
		}
	};

	$('#_department_tree').click(function() {
		layer.open({
			title:'所属部门',
		    type: 2,
		    area: ['580px', '530px'],
		    fix: false, //不固定
		    content: '${CPATH}/admin/department/department_tree'
		});
		});

	function doSubmit(){
		var validate = $form.data('bootstrapValidator');
		validate.validate();
		if(!validate.isValid()){
			return;
		}
		window.open('${CPATH}/admin/salesOutstock/downloading?startDate=' + $('#startDate').val() + " 00:00:00" + '&endDate=' + $('#endDate').val() + " 23:59:59" + '&printStatus=' + $("#printStatus").val() + '&stockOutStatus='+$("#stockOutStatus").val());
	}
	
	/*//获取车销仓库
	 var initCarWarehouse = function () {
	        var strHtml = "";
	        var url = '${CPATH}/admin/salesOutstock/queryCarWarehouse';
	        $.ajax({
	            url: url,
	            type: 'post',
	            success: function (result) {
	                var carWarehouse = result.data;
	                strHtml = '<option selected="selected" value="">车销仓库选择</option>';
	                for(index in carWarehouse){
	                    var row = carWarehouse[index];
	                    strHtml +='<option value="'+row.id+'">'+row.name+'</option>';
	                }
	                $("#carWarehouse").html(strHtml);
	            }
	        });
	    }*/
	    
	   var validatorFields = {
		'startDate': {
			validators: {
				date : { format : 'YYYY-MM-DD', message : '日期格式不正确' }
			}
		},
		'endDate': {
			validators: {
				date : { format : 'YYYY-MM-DD', message : '日期格式不正确' }
			}
		}
	};
</#macro>

<@layout active_id=p child_active_id=c>

<!-- Content Header (Page header) -->
<section class="content-header">
	<h1>导出出库单</h1>
	<ol class="breadcrumb">
		<li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
	<li>仓库管理</li>
		<li class="active">导出出库订单</li>
	</ol>
</section>
<!-- Main content -->
<section class="content">
	<div class="box box-default">
		<div class="box-header with-border">
			<h3 class="box-title">导出</h3>
			<div class="box-tools">
				<button type="button" class="btn btn-box-tool" data-widget="collapse">
					<i class="fa fa-minus"></i>
				</button>
			</div>
		</div>
		<form id="form" class="form-horizontal" >
			<div class="box-body">
				<div class="control-label">
					<label class="control-label col-sm-2">开始时间:</label>
					<div class="input-group col-md-4 col-sm-10">
						<input id="startDate" class="form-control" value="${startDate!}" name="startDate" placeholder="开始日期" >&nbsp;
					</div>
				</div>
				<div class="control-label">
					<label class="control-label col-sm-2">结束时间:</label>
					<div class="input-group col-md-4 col-sm-10">
						<input id="endDate" class="form-control" value="${endDate!}" name="endDate" placeholder="结束日期" >&nbsp;
					</div>
				</div>
				<div class="control-label">
					<label class="control-label col-sm-2">打印状态&nbsp; </label>
					<div class="input-group col-md-4 col-sm-10">
		                <select class="form-control" name="printStatus" id="printStatus" style="padding-right:5px;margin-right:60px;">
		                    <option value="">全部</option>
		                    <option value="0" selected="selected">未打印</option>
		                    <option value="1">已打印</option>
		                </select>
	                </div>
	            </div>
				<div class="control-label" style="margin-top:20px;">
	                <label class="control-label col-sm-2">出库单状态&nbsp;</label>
	                <div class="input-group col-md-4 col-sm-10">
		                 <select class="form-control" name="stockOutStatus" id="stockOutStatus" style="padding-right:5px;margin-right:55px;">
		                    <option value="">全部</option>
		                    <option value="0" selected="selected">待出库</option>
		                    <option value="1000">已出库</option>
		                </select>
	                </div>
	             </div>
	                <!-- <label class="control-label col-sm-2">仓库选择&nbsp;</label>
	                <div class="input-group col-md-4 col-sm-10">
	                	 <select class="form-control" name="carWarehouse" id="carWarehouse" style="padding-right:5px;margin-right:55px;">
	                	</select>
	                </div> -->
			</div>
		</form>
	
		<div class="box-footer"> 
			<button type="button" onclick="doSubmit()" class="btn btn-primary">导出</button>
			<input type="button" class="btn btn-primary" onclick="window.history.back(); return false;" value="返  回" hidefocus="true" />
		</div>
	</div>
</section>

</@layout>