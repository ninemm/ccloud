<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>登录渠道云</title>

  	<meta name=”renderer” content=”webkit”>
  	<meta http-equiv=”X-UA-Compatible” content=”IE=Edge,chrome=1″ >
  	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" >
  
	<!-- Bootstrap 3.3.5 -->
	<link rel="stylesheet" href="${CPATH}/static/bootstrap/css/bootstrap.min.css">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="${CPATH}/static/font-awesome/css/font-awesome.css">
	
	<!-- Theme style -->
	<link rel="stylesheet" href="${CPATH}/static/lte/css/AdminLTE.min.css">
	<link rel="stylesheet" href="${CPATH}/static/plugins/pace/pace.min.css">
	
	<!--[if lt IE 9]>
	 <script src="${CPATH}/static/plugins/html5/html5shiv.min.js"></script>
	 <script src="${CPATH}/static/plugins/html5/respond.min.js"></script>
	<![endif]-->
</head>
<body class="hold-transition login-page">
	<div class="login-box">
		<div class="login-logo">
			<a href="#"><b>渠道云平台 V2.0</b></a>
		</div>
		<!-- /.login-logo -->
		<div class="login-box-body">
			<p class="login-box-msg">管理员登录</p>

			<form action="${CPATH}/admin/login" method="post" id="loginform">
				<div class="form-group has-feedback">
					<label>用户名：</label> 
					<input class="form-control" name="username" value="admin">
					<span class="glyphicon glyphicon-envelope form-control-feedback"></span>
				</div>
				<div class="form-group has-feedback">
					<label>密码：</label> 
					<input type="password" name="password" class="form-control" value="123456"> 
					<span class="glyphicon glyphicon-lock form-control-feedback"></span>
				</div>
				<div class="row">
					<div class="col-xs-8">
						<div class="form-group checkbox">
							<label> <input type="checkbox" name="remember_me">
								记住我的登录信息
							</label>
						</div>
					</div>
					<!-- /.col -->
					<div class="col-xs-4">
						<button type="submit" class="btn btn-primary btn-block btn-flat">登录</button>
					</div>
					<!-- /.col -->
				</div>
			</form>
			<!-- /.social-auth-links -->
		</div>
		<!-- /.login-box-body -->
	</div>
	<!-- /.login-box -->
	<div class="modal fade" tabindex="-1" role="dialog"
		aria-labelledby="gridSystemModalLabel" id="sellerModal">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title" id="gridSystemModalLabel">选择账套</h4>
				</div>
				<div class="modal-body">
					<div class="form-group col-sm-12 validata-box">
						<label class="control-label col-sm-2">账套:</label>
						<div class="input-group col-md-6 col-sm-10">					
							<select class="form-control input-sm" id="seller_id">
							</select>
						</div>	
					</div>						
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-primary" onclick="changeSeller();">确认选择</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- jQuery 2.1.4 -->
	<script src="${CPATH}/static/plugins/jquery/jquery-2.1.4.min.js"></script>
	<script src="${CPATH}/static/plugins/jquery/jquery.form.min.js"></script>
	<!-- Bootstrap 3.3.5 -->
	<script src="${CPATH}/static/bootstrap/js/bootstrap.min.js"></script>
	<script src="${CPATH}/static/plugins/pace/pace.min.js"></script>
	<script>
		$(function() {
			$(document).ajaxStart(function() {
				Pace.restart();
			});

			$("#loginform").submit(function() {
				$(this).ajaxSubmit({
					type : "post", 
					dataType : "json", 
					success : function(data) { 
						if (data.errorCode == 0) {
							var sellerSize = data.data;
							$("#seller_id").empty();
							if (sellerSize.length > 1) {
								for (var i = 0; i < sellerSize.length; i++) {
									$("#seller_id").append("<option value=" + sellerSize[i].sellerId + ">" + sellerSize[i].sellerName + "</option>");
								}								
								$("#sellerModal").modal('show');
							} else {
								window.location.href = "${CPATH}/admin/index";
							}
						} else {
							alert(data.message);
						}
					},
					error : function() {
						alert("信息提交错误");
					}
				});
				return false; //不刷新页面  
			});
		});
		function changeSeller() {
			var sellerId = $("#seller_id").find("option:selected").val();
			var sellerName = $("#seller_id").find("option:selected").text();
			$.ajax({
				url:"${CPATH}/admin/seller/changeSeller",
				type:"post",
				data:{
					"sellerId":sellerId,
					"sellerName":sellerName	
				},
				dataType:"json",
				success:function(data) {
					window.location.href = "${CPATH}/admin/index";
				}
			});
		}		
	</script>
</body>
</html>
